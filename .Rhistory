legend_pos = "bottom", legend_size = 0.25)
graphic
plotting.table
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))[order(-Length)]
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = "Chr")
length.table
# Set levels so that chromosomes are plotted in the proper order by number
length.table$Chromosome <- factor(length.table$Chromosome,
levels = unique(length.table$Chromosome)[order(as.numeric(gsub("Chr", "", unique(length.table$Chromosome))))])
length.table$Chromosome
length.table
# Extract the size of the genome
genome.size <- sum(length.table$Length)
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e6, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
tel_count.table
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 25 | TTTAGGG_Counts >= 25)
tel.table
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
plotting.table$Chromosome
plotting.table$Chromosome
enome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = "Chr")
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = "Chr")
genome.size <- sum(length.table$Length)
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e6, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 25 | TTTAGGG_Counts >= 25)
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
# plot the ideogram
graphic <- primary_ideogram(plotting.table, plot_title = "tester", chr_color = "orange", chr_size = 6,
tel_color = "grey5", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25)
graphic
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = "Chr")
# Set levels so that chromosomes are plotted in the proper order by number
length.table$Chromosome <- factor(length.table$Chromosome,
levels = unique(length.table$Chromosome)[order(as.numeric(gsub("Chr", "", unique(length.table$Chromosome))))])
# Extract the size of the genome
genome.size <- sum(length.table$Length)
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e5, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 5 | TTTAGGG_Counts >= 5)
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
plotting.table$Chromosome
# Set levels so that chromosomes are plotted in the proper order by number
plotting.table$Chromosome <- factor(plotting.table$Chromosome,
levels = unique(plotting.table$Chromosome)[order(as.numeric(gsub("Chr", "", unique(plotting.table$Chromosome))))])
# plot the ideogram
graphic <- primary_ideogram(plotting.table, plot_title = "tester", chr_color = "orange", chr_size = 6,
tel_color = "grey5", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25)
graphic
#' The function identifies and removes leading zeros from chromosome identifiers that match the specified prefix in the format `Chr01`, `Chr02`, ..., `Chr09`.
#' This adjustment ensures chromosome numbers are consistently formatted for downstream analysis.
#'
#' @examples
#' # Example usage
#' data <- data.frame(Chromosome = c("Chr01", "Chr02", "Chr10"))
#' remove_lead_0s(data, chr_string = "Chr")
#' # Output will be a data frame with Chromosome values: "Chr1", "Chr2", "Chr10"
#'
#' @export
remove_lead_0s <- function(data, chr_string = "Chr") {
# Remove leading zero from chromosome numbers 01-09
data$Chromosome <- sub(paste0("^", chr_string, "0(\\d)$"), paste0(chr_string, "\\1"), data$Chromosome)
return(data)
}
# Read in fasta
genome <- readDNAStringSet(path_fasta)
#'
#' @return A data frame containing only the rows where the `Chromosome` column contains the specified `chr_string`.
#'
#' @examples
#' # Example usage
#' data <- data.frame(Chromosome = c("Chr1", "Chr2", "Scaffold1", "Chr3"),
#'                    Value = c(100, 200, 300, 400))
#' select_chr(data, chr_string = "Chr")
#'
#' @export
select_chr <- function(data, chr_string = "Chr"){
# Remove extraneous scaffolds
data <- data[grepl(chr_string, data$Chromosome),]
return(data)
}
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = "Chr")
# Extract the size of the genome
genome.size <- sum(length.table$Length)
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e5, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 25 | TTTAGGG_Counts >= 25)
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
# Remove leading 0s for proper ordering and plotting
plotting.table <- remove_lead_0s(plotting.table)
plotting.table
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = "Chr")
# Extract the size of the genome
genome.size <- sum(length.table$Length)
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e5, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 25 | TTTAGGG_Counts >= 25)
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
plotting.table
#'
#' @return A data frame containing only the rows where the `Chromosome` column contains the specified `chr_string`.
#'
#' @examples
#' # Example usage
#' data <- data.frame(Chromosome = c("Chr1", "Chr2", "Scaffold1", "Chr3"),
#'                    Value = c(100, 200, 300, 400))
#' select_chr(data, chr_string = "Chr")
#'
#' @export
select_chr <- function(data, chr_string = "Chr"){
# Remove extraneous scaffolds
data <- data[grepl(chr_string, data$Chromosome),]
return(data)
}
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table,)
# Extract the size of the genome
genome.size <- sum(length.table$Length)
length.table
genome.size
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e5, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
tel_count.table
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 25 | TTTAGGG_Counts >= 25)
tel.table
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 40 | TTTAGGG_Counts >= 40)
tel.table
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 100 | TTTAGGG_Counts >= 100)
tel.table
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 50 | TTTAGGG_Counts >= 50)
tel.table
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
plotting.table
View(plotting.table)
# Remove leading 0s for proper ordering and plotting
plotting.table <- remove_lead_0s(plotting.table)
# Set levels so that chromosomes are plotted in the proper order by number
plotting.table$Chromosome <- factor(plotting.table$Chromosome,
levels = unique(plotting.table$Chromosome)[order(as.numeric(gsub("Chr", "", unique(plotting.table$Chromosome))))])
plotting.table$Chromosome
# plot the ideogram
graphic <- primary_ideogram(plotting.table, plot_title = "tester", chr_color = "orange", chr_size = 6,
tel_color = "grey5", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25)
graphic
library(data.table)
library(tidyverse)
library(scales)
library(Biostrings)
library(pbapply)
library(devtools) # Make sure that the devtools library is loaded
install_github("matthewwdavis/ggideo")
library(ggideo)
ggideoprimary("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
library(data.table)
library(tidyverse)
library(scales)
library(Biostrings)
library(pbapply)
library(devtools) # Make sure that the devtools library is loaded
install_github("matthewwdavis/ggideo")
library(ggideo)
ggideoprimary("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table)
# Extract the size of the genome
genome.size <- sum(length.table$Length)
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e6, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 50 | TTTAGGG_Counts >= 50)
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
# Remove leading 0s for proper ordering and plotting
plotting.table <- remove_lead_0s(plotting.table)
# Set levels so that chromosomes are plotted in the proper order by number
plotting.table$Chromosome <- factor(plotting.table$Chromosome,
levels = unique(plotting.table$Chromosome)[order(as.numeric(gsub("Chr", "", unique(plotting.table$Chromosome))))])
# plot the ideogram
graphic <- primary_ideogram(plotting.table, plot_title = "tester", chr_color = "orange", chr_size = 6,
tel_color = "grey5", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25)
View(graphic)
graphic
plot(graphic)
chr_string = "Chr"
chr_names = "Chr"
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = chr_names)
length.table
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = chr_names)
length.table
# Extract the size of the genome
genome.size <- sum(length.table$Length)
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e6, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 50 | TTTAGGG_Counts >= 50)
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
# Remove leading 0s for proper ordering and plotting
plotting.table <- remove_lead_0s(plotting.table)
plotting.table
chr_names = "Chr"
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = chr_names)
# Extract the size of the genome
genome.size <- sum(length.table$Length)
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e6, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 50 | TTTAGGG_Counts >= 50)
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
# Remove leading 0s for proper ordering and plotting
plotting.table <- remove_lead_0s(plotting.table, chr_string = chr_names)
# Set levels so that chromosomes are plotted in the proper order by number
plotting.table$Chromosome <- factor(plotting.table$Chromosome,
levels = unique(plotting.table$Chromosome)[order(as.numeric(gsub(chr_names, "", unique(plotting.table$Chromosome))))])
plotting.table$Chromosome
# plot the ideogram
graphic <- primary_ideogram(plotting.table, plot_title = "tester", chr_color = "orange", chr_size = 6,
tel_color = "grey5", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25)
plot(graphic)
library(data.table)
library(tidyverse)
library(scales)
library(Biostrings)
library(pbapply)
library(devtools) # Make sure that the devtools library is loaded
install_github("matthewwdavis/ggideo")
library(ggideo)
ggideoprimary("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
getwd()
devtools::document()
library(ggideo)
ggideoprimary("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
devtools::install_github("matthewwdavis/ggideo")
getwd()
roxygen2::roxygenise()
roxygen2::roxygenise()
getwd()
roxygen2::roxygenise()
roxygen2::roxygenize()
devtools::install()
roxygen2::roxygenise()
devtools::install()
library(ggideo)
ggideoprimary("~/Desktop/Col-CEN_v1.2.fasta")
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa")
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta", chr_names = "")
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "")
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "//d")
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "\\d")
?ggideo
??ggideo
roxygen2::roxygenise()
devtools::install_github("matthewwdavis/ggideo")
library(ggideo)
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "\\d")
devtools::install_github("matthewwdavis/ggideo")
library(ggideo)
## Need to work on removing trailing strings
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "\\d")
devtools::install_github("matthewwdavis/ggideo")
library(ggideo)
## Need to work on removing trailing strings
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "\\d")
devtools::install_github("matthewwdavis/ggideo")
library(ggideo)
## Need to work on removing trailing strings
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "\\d")
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "")
devtools::install_github("matthewwdavis/ggideo")
library(ggideo)
## Need to work on removing trailing strings
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "")
devtools::install_github("matthewwdavis/ggideo")
library(ggideo)
## Need to work on removing trailing strings
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "")
#'   end_telo_end = c(100000000, 200000000),
#'   begin_telo_bp = c(5000000, 10000000),
#'   end_telo_bp = c(5000000, 10000000)
#' )
#' primary_ideogram(genome.table)
#'
#' @importFrom ggplot2 ggplot filter aes geom_segment geom_point labs theme_classic theme element_text scale_y_continuous
#' @importFrom scales label_number
#'
#' @export
primary_ideogram <- function(genome.table, plot_title = NULL, x_axis_title = NULL, y_axis_title = "Chromosome Length",
legend_title = "Telomere Length", chr_color = "dodgerblue2", chr_size = 8,
tel_color = "black", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25) {
p <- genome.table %>%
filter(begin_telo_bp != 0 & end_telo_bp != 0) %>%
ggplot(aes(x = Chromosome, y = Length)) +
geom_segment(aes(y = begin_telo_start, yend = Length),
color = chr_color,
linewidth = chr_size,
lineend = "round") +
geom_point(aes(x = Chromosome, y = begin_telo_end, size = begin_telo_bp),
shape = tel_shape,
color = tel_color) +
geom_point(aes(x = Chromosome, y = end_telo_end, size = end_telo_bp),
shape = tel_shape,
color = tel_color) +
scale_y_continuous(labels = label_number(scale = y_scale, suffix = y_scale_suffix)) +
labs(y = y_axis_title, x = x_axis_title, size = legend_title, title = plot_title) +
theme_classic(base_size = 6) +
theme(legend.position = legend_pos,
legend.key.size = unit(legend_size, "cm"),
plot.title = element_text(hjust = 0.5, face = "bold"))
return(p)
}
# List all R script files in the folder
files <- list.files("~/Projects/ggideo/R/", pattern = "\\.R$", full.names = TRUE)
# Source each file
sapply(files, source)
chr_names = "Chr"
genome <- readDNAStringSet("~/Desktop/Pvera_Kerman_RefGen_v1_15Chr.fasta")
# Create table of contigs, chromosomes, and lengths
length.table <- data.table(Chromosome = names(genome), Length = width(genome))
# Filter for only chromosomes, based on starting string
length.table <- select_chr(length.table, chr_string = chr_names)
# Extract the size of the genome
genome.size <- sum(length.table$Length)
# Count telomeric sequence repeat
tel_count.table <- telomere_repeat_number(fasta = genome, window = 1e6, tel_start = "CCCTAAA", tel_end = "TTTAGGG")
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 50 | TTTAGGG_Counts >= 50)
tel.table
# Filter to maintain telomeric counts over a certain threshold
tel.table <- tel_count.table %>%
filter(CCCTAAA_Counts >= 50 | TTTAGGG_Counts >= 50)
# Create the larger table necessary for plotting
plotting.table <- genome_table(length.table, tel.table, name = "kerman", genome_size = genome.size)
# Remove leading 0s for proper ordering and plotting
plotting.table <- remove_lead_0s(plotting.table, chr_string = chr_names)
plotting.table
# Set levels so that chromosomes are plotted in the proper order by number
plotting.table$Chromosome <- factor(plotting.table$Chromosome,
levels = unique(plotting.table$Chromosome)[order(as.numeric(gsub(chr_names, "", unique(plotting.table$Chromosome))))])
View(plotting.table)
# plot the ideogram
graphic <- primary_ideogram(plotting.table, plot_title = "tester", chr_color = "orange", chr_size = 6,
tel_color = "grey5", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25)
graphic
#'   end_telo_end = c(100000000, 200000000),
#'   begin_telo_bp = c(5000000, 10000000),
#'   end_telo_bp = c(5000000, 10000000)
#' )
#' primary_ideogram(genome.table)
#'
#' @importFrom ggplot2 ggplot filter aes geom_segment geom_point labs theme_classic theme element_text scale_y_continuous
#' @importFrom scales label_number
#'
#' @export
primary_ideogram <- function(genome.table, plot_title = NULL, x_axis_title = NULL, y_axis_title = "Chromosome Length",
legend_title = "Telomere Length", chr_color = "dodgerblue2", chr_size = 8,
tel_color = "black", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25) {
p <- genome.table %>%
filter(begin_telo_bp != 0 | end_telo_bp != 0) %>%
ggplot(aes(x = Chromosome, y = Length)) +
geom_segment(aes(y = begin_telo_start, yend = Length),
color = chr_color,
linewidth = chr_size,
lineend = "round") +
geom_point(aes(x = Chromosome, y = begin_telo_end, size = begin_telo_bp),
shape = tel_shape,
color = tel_color) +
geom_point(aes(x = Chromosome, y = end_telo_end, size = end_telo_bp),
shape = tel_shape,
color = tel_color) +
scale_y_continuous(labels = label_number(scale = y_scale, suffix = y_scale_suffix)) +
labs(y = y_axis_title, x = x_axis_title, size = legend_title, title = plot_title) +
theme_classic(base_size = 6) +
theme(legend.position = legend_pos,
legend.key.size = unit(legend_size, "cm"),
plot.title = element_text(hjust = 0.5, face = "bold"))
return(p)
}
# plot the ideogram
graphic <- primary_ideogram(plotting.table, plot_title = "tester", chr_color = "orange", chr_size = 6,
tel_color = "grey5", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25)
plot(graphic)
#'   end_telo_end = c(100000000, 200000000),
#'   begin_telo_bp = c(5000000, 10000000),
#'   end_telo_bp = c(5000000, 10000000)
#' )
#' primary_ideogram(genome.table)
#'
#' @importFrom ggplot2 ggplot filter aes geom_segment geom_point labs theme_classic theme element_text scale_y_continuous
#' @importFrom scales label_number
#'
#' @export
primary_ideogram <- function(genome.table, plot_title = NULL, x_axis_title = NULL, y_axis_title = "Chromosome Length",
legend_title = "Telomere Length", chr_color = "dodgerblue2", chr_size = 8,
tel_color = "black", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25) {
p <- genome.table %>%
ggplot(aes(x = Chromosome, y = Length)) +
geom_segment(aes(y = begin_telo_start, yend = Length),
color = chr_color,
linewidth = chr_size,
lineend = "round") +
geom_point(aes(x = Chromosome, y = begin_telo_end, size = ifelse(begin_telo_bp == 0, NA, begin_telo_bp)),
shape = tel_shape,
color = tel_color) +
geom_point(aes(x = Chromosome, y = end_telo_end, size = ifelse(end_telo_bp == 0, NA, end_telo_bp)),
shape = tel_shape,
color = tel_color) +
scale_y_continuous(labels = label_number(scale = y_scale, suffix = y_scale_suffix)) +
labs(y = y_axis_title, x = x_axis_title, size = legend_title, title = plot_title) +
theme_classic(base_size = 6) +
theme(legend.position = legend_pos,
legend.key.size = unit(legend_size, "cm"),
plot.title = element_text(hjust = 0.5, face = "bold"))
return(p)
}
# plot the ideogram
graphic <- primary_ideogram(plotting.table, plot_title = "tester", chr_color = "orange", chr_size = 6,
tel_color = "grey5", tel_shape = 16, y_scale = 1e-6, y_scale_suffix = "Mb",
legend_pos = "bottom", legend_size = 0.25)
graphic
roxygen2::roxygenize()
roxygen2::roxygenize()
rm(list = c("count_sequence", "create_windows", "genome_table", "ggideoprimary", "primary_ideogram", "remove_lead_0s", "remove_trailing", "rename_chr",
"select_chr", "telomere_repeat_number"))
roxygen2::roxygenize()
roxygen2::roxygenize()
roxygen2::roxygenize()
devtools::install_github("matthewwdavis/ggideo")
library(ggideo)
## Need to work on removing trailing strings
ggideoprimary("~/Desktop/Arabidopsis_thaliana.TAIR10.dna.toplevel.fa", chr_names = "")
library(ggideo)
ggideoprimary("~/Projects/Streptanthus/Genome_Assembly/Inputs/Assemblies/S.div.fasta")
ggsave("~/Desktop/strep_test.pdf", height = 3, width = 4)
